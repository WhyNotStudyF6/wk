import tkinter as tk
import random
import screeninfo

def chuangjian_chuangkou(chuangkou_mingcheng, chuangkou_weizhi="é»˜è®¤", chuangkou_daxiao="é»˜è®¤", chuangkou_zhiding=False, chuangkou_lashen="ä¸æ‹‰ä¼¸"):
    """
    ğŸ—ï¸ åˆ›å»ºä¸€ä¸ªé«˜åº¦å¯å®šåˆ¶çš„Tkinterçª—å£
    
    ğŸ“Œ å‚æ•°è¯´æ˜:
    ----------------------------
    chuangkou_mingcheng: str
        ğŸ·ï¸ çª—å£æ ‡é¢˜ - æ˜¾ç¤ºåœ¨çª—å£é¡¶éƒ¨çš„åç§°
        ğŸŒ èŒƒå›´: ä»»æ„å­—ç¬¦ä¸²ï¼Œå»ºè®®é•¿åº¦ä¸è¶…è¿‡50ä¸ªå­—ç¬¦
        ğŸŒŸ ç¤ºä¾‹: "æˆ‘çš„åº”ç”¨", "æ•°æ®åˆ†æå·¥å…·" ç­‰
        
    chuangkou_weizhi: str
        ğŸ“ çª—å£ä½ç½® - æ”¯æŒä»¥ä¸‹æ ¼å¼:
        ğŸ¯ åæ ‡å½¢å¼: "æ•°å­—*æ•°å­—" å¦‚ "300*200"
        ğŸ“Š ç™¾åˆ†æ¯”å½¢å¼: "ç™¾åˆ†æ¯”*ç™¾åˆ†æ¯”" å¦‚ "50%*30%"
        ğŸ”¢ å•ç™¾åˆ†æ¯”: "ç™¾åˆ†æ¯”" å¦‚ "50%" (ç›¸å½“äº"50%*50%")
        ğŸ”‘ å…³é”®è¯å½¢å¼: 
            "é»˜è®¤"â†’å±…ä¸­ | "å·¦ä¸Š" | "å³ä¸Š" | "å·¦ä¸‹" | "å³ä¸‹" 
            "å±…ä¸­" | "ä¸Šä¸­" | "ä¸‹ä¸­" | "å·¦ä¸­" | "å³ä¸­"
            "åå·¦ä¸Š" | "åå³ä¸Š" | "åå·¦ä¸‹" | "åå³ä¸‹"
            "éšæœº"â†’éšæœºä½ç½®
        âš ï¸ æ³¨æ„: 
        - æ•°å­—åæ ‡èŒƒå›´: 0 â‰¤ x â‰¤ å±å¹•å®½åº¦, 0 â‰¤ y â‰¤ å±å¹•é«˜åº¦
        - ç™¾åˆ†æ¯”èŒƒå›´: 1% ~ 100%
        
    chuangkou_daxiao: str
        ğŸ“ çª—å£å¤§å° - æ”¯æŒä»¥ä¸‹æ ¼å¼:
        ğŸ“ å°ºå¯¸å½¢å¼: "æ•°å­—*æ•°å­—" å¦‚ "800*600"
        ğŸ“ˆ ç™¾åˆ†æ¯”å½¢å¼: "ç™¾åˆ†æ¯”*ç™¾åˆ†æ¯”" å¦‚ "80%*60%"
        ğŸ”¢ å•ç™¾åˆ†æ¯”: "ç™¾åˆ†æ¯”" å¦‚ "70%" (ç›¸å½“äº"70%*70%")
        ğŸ”‘ å…³é”®è¯å½¢å¼:
            "é»˜è®¤"â†’å±…ä¸­åŠå± | "æœ€å¤§åŒ–"â†’å…¨å±
            "å·¦åŠå±" | "å³åŠå±" | "ä¸ŠåŠå±" | "ä¸‹åŠå±"
            "å±…ä¸­åŠå±"â†’å®½é«˜å„åŠå±
        âš ï¸ æ³¨æ„:
        - æœ€å°å°ºå¯¸é™åˆ¶: 100*100åƒç´ 
        - ç™¾åˆ†æ¯”èŒƒå›´: 10% ~ 100%
        
    chuangkou_zhiding: bool
        ğŸ“Œ çª—å£ç½®é¡¶ - æ˜¯å¦ä¿æŒåœ¨æœ€ä¸Šå±‚
        âœ… True: ç½®é¡¶ | âŒ False: ä¸ç½®é¡¶
        ğŸ”„ è¿è¡Œæ—¶å¯é€šè¿‡window.attributes('-topmost', True/False)åŠ¨æ€ä¿®æ”¹
        
    chuangkou_lashen: str
        ğŸ‹ï¸ çª—å£æ‹‰ä¼¸æ–¹å¼:
        "ä¸æ‹‰ä¼¸"â†’å›ºå®šå¤§å° | "ä»»æ„æ‹‰ä¼¸"â†’è‡ªç”±è°ƒæ•´
        "æŒ‰æ¯”ä¾‹æ‹‰ä¼¸"â†’ä¿æŒå®½é«˜æ¯”è°ƒæ•´
        âš ï¸ æ³¨æ„: 
        - é€‰æ‹©"æŒ‰æ¯”ä¾‹æ‹‰ä¼¸"æ—¶ï¼Œçª—å£åˆå§‹å¤§å°å†³å®šå®½é«˜æ¯”
        - "æœ€å¤§åŒ–"çª—å£æ—¶å»ºè®®é€‰æ‹©"ä¸æ‹‰ä¼¸"
        
    ğŸ è¿”å›å€¼: tk.Tk çª—å£å¯¹è±¡
    """
    
    # è·å–å±å¹•å°ºå¯¸ ğŸ–¥ï¸
    try:
        screen = screeninfo.get_monitors()[0]
        screen_width = screen.width
        screen_height = screen.height
    except:
        # å¤‡ç”¨æ–¹æ¡ˆï¼šä½¿ç”¨Tkinterè·å–å±å¹•å°ºå¯¸
        root = tk.Tk()
        screen_width = root.winfo_screenwidth()
        screen_height = root.winfo_screenheight()
        root.destroy()
    
    # åˆ›å»ºçª—å£ ğŸ—ï¸
    window = tk.Tk()
    window.title(f"{chuangkou_mingcheng}")
    
    # å¤„ç†çª—å£ä½ç½® ğŸ“
    def chuli_weizhi(weizhi):
        # å¤„ç†å…³é”®è¯ä½ç½®
        weizhi_dict = {
            "é»˜è®¤": (screen_width//2, screen_height//2),
            "å·¦ä¸Š": (0, 0),
            "å³ä¸Š": (screen_width, 0),
            "å·¦ä¸‹": (0, screen_height),
            "å³ä¸‹": (screen_width, screen_height),
            "å±…ä¸­": (screen_width//2, screen_height//2),
            "ä¸Šä¸­": (screen_width//2, 0),
            "ä¸‹ä¸­": (screen_width//2, screen_height),
            "å·¦ä¸­": (0, screen_height//2),
            "å³ä¸­": (screen_width, screen_height//2),
            "åå·¦ä¸Š": (screen_width//4, screen_height//4),
            "åå³ä¸Š": (screen_width*3//4, screen_height//4),
            "åå·¦ä¸‹": (screen_width//4, screen_height*3//4),
            "åå³ä¸‹": (screen_width*3//4, screen_height*3//4),
            "éšæœº": (random.randint(0, screen_width), random.randint(0, screen_height))
        }
        
        if weizhi in weizhi_dict:
            left, top = weizhi_dict[weizhi]
            return f"+{left}+{top}"
        
        # å¤„ç†æ•°å­—*æ•°å­— æˆ– ç™¾åˆ†æ¯”*ç™¾åˆ†æ¯” æˆ– å•ç™¾åˆ†æ¯”
        if '*' in weizhi:
            parts = weizhi.split('*')
            left_part = parts[0].strip()
            top_part = parts[1].strip()
        else:
            left_part = top_part = weizhi.strip()
        
        # å¤„ç†ç™¾åˆ†æ¯”
        if '%' in left_part:
            left_percent = max(1, min(100, int(left_part.replace('%', '').strip() or 50))
            left = int(screen_width * left_percent / 100)
        else:
            left = max(0, min(screen_width, int(left_part or screen_width//2))
        
        if '%' in top_part:
            top_percent = max(1, min(100, int(top_part.replace('%', '').strip() or 50))
            top = int(screen_height * top_percent / 100)
        else:
            top = max(0, min(screen_height, int(top_part or screen_height//2))
            
        return f"+{left}+{top}"
    
    # å¤„ç†çª—å£å¤§å° ğŸ“
    def chuli_daxiao(daxiao):
        # å¤„ç†å…³é”®è¯å¤§å°
        daxiao_dict = {
            "é»˜è®¤": (screen_width//2, screen_height//2),
            "æœ€å¤§åŒ–": (screen_width, screen_height),
            "å·¦åŠå±": (screen_width//2, screen_height),
            "å³åŠå±": (screen_width//2, screen_height),
            "ä¸ŠåŠå±": (screen_width, screen_height//2),
            "ä¸‹åŠå±": (screen_width, screen_height//2),
            "å±…ä¸­åŠå±": (screen_width//2, screen_height//2)
        }
        
        if daxiao in daxiao_dict:
            width, height = daxiao_dict[daxiao]
            return f"{width}x{height}"
        
        # å¤„ç†æ•°å­—*æ•°å­— æˆ– ç™¾åˆ†æ¯”*ç™¾åˆ†æ¯” æˆ– å•ç™¾åˆ†æ¯”
        if '*' in daxiao:
            parts = daxiao.split('*')
            width_part = parts[0].strip()
            height_part = parts[1].strip()
        else:
            width_part = height_part = daxiao.strip()
        
        # å¤„ç†ç™¾åˆ†æ¯”
        if '%' in width_part:
            width_percent = max(10, min(100, int(width_part.replace('%', '').strip() or 50))
            width = int(screen_width * width_percent / 100)
        else:
            width = max(100, min(screen_width, int(width_part or screen_width//2))
        
        if '%' in height_part:
            height_percent = max(10, min(100, int(height_part.replace('%', '').strip() or 50))
            height = int(screen_height * height_percent / 100)
        else:
            height = max(100, min(screen_height, int(height_part or screen_height//2))
            
        return f"{width}x{height}"
    
    # è®¾ç½®çª—å£å‡ ä½•å±æ€§ âœ¨
    try:
        window.geometry(f"{chuli_daxiao(chuangkou_daxiao)}{chuli_weizhi(chuangkou_weizhi)}")
    except Exception as e:
        print(f"âš ï¸ çª—å£è®¾ç½®é”™è¯¯: {e}, ä½¿ç”¨é»˜è®¤è®¾ç½®")
        window.geometry(f"{screen_width//2}x{screen_height//2}+{screen_width//4}+{screen_height//4}")
    
    # è®¾ç½®çª—å£ç½®é¡¶ ğŸ“Œ
    if chuangkou_zhiding:
        window.attributes('-topmost', True)
    
    # è®¾ç½®çª—å£æ‹‰ä¼¸æ–¹å¼ ğŸ‹ï¸
    if chuangkou_lashen == "ä¸æ‹‰ä¼¸":
        window.resizable(False, False)
    elif chuangkou_lashen == "æŒ‰æ¯”ä¾‹æ‹‰ä¼¸":
        # ä¿æŒå®½é«˜æ¯” ğŸ”„
        try:
            # è·å–åˆå§‹å®½é«˜
            geom = window.geometry()
            width, height = map(int, geom.split('+')[0].split('x'))
            aspect_ratio = width / height
            
            def enforce_aspect_ratio(event):
                if event.widget != window:
                    return
                    
                # è®¡ç®—æ–°å°ºå¯¸ä¿æŒå®½é«˜æ¯”
                new_width = event.width
                new_height = int(new_width / aspect_ratio)
                
                # ç¡®ä¿æœ€å°å°ºå¯¸
                if new_width < 100 or new_height < 100:
                    return
                    
                # åº”ç”¨æ–°å°ºå¯¸
                window.geometry(f"{new_width}x{new_height}")
            
            window.bind("<Configure>", enforce_aspect_ratio)
        except Exception as e:
            print(f"âš ï¸ æŒ‰æ¯”ä¾‹æ‹‰ä¼¸è®¾ç½®å¤±è´¥: {e}, ä½¿ç”¨é»˜è®¤æ‹‰ä¼¸æ–¹å¼")
            window.resizable(True, True)
    else:  # "ä»»æ„æ‹‰ä¼¸"
        window.resizable(True, True)
    
    return window