import tkinter as tk
import random
import screeninfo

def chuangjian_chuangkou(chuangkou_mingcheng, chuangkou_weizhi="é»˜è®¤", chuangkou_daxiao="é»˜è®¤", chuangkou_zhiding=False, chuangkou_lashen="ä¸æ‹‰ä¼¸"):
    """
    ğŸ—ï¸ åˆ›å»ºä¸€ä¸ªé«˜åº¦å¯å®šåˆ¶çš„Tkinterçª—å£
    
    ğŸ“Œ å‚æ•°è¯´æ˜:
    ----------------------------
    chuangkou_mingcheng: str
        ğŸ·ï¸ çª—å£åç§°/æ ‡é¢˜ - æ˜¾ç¤ºåœ¨çª—å£é¡¶éƒ¨çš„åç§°
        ğŸŒ èŒƒå›´: ä»»æ„å­—ç¬¦ä¸²ï¼Œå»ºè®®é•¿åº¦ä¸è¶…è¿‡50ä¸ªå­—ç¬¦
        ğŸŒŸ ç¤ºä¾‹: "æˆ‘çš„åº”ç”¨", "æ•°æ®åˆ†æå·¥å…·" ç­‰
        
    chuangkou_weizhi: str/tuple
        ğŸ“ çª—å£ä½ç½® - é¦–æ¬¡æ‰“å¼€çª—å£æ—¶çª—å£çš„ä½ç½®,æ”¯æŒä»¥ä¸‹æ ¼å¼:
        ğŸ¯ åæ ‡å½¢å¼: "æ•°å­—*æ•°å­—" å¦‚ "300*200"
        ğŸ“Š ç™¾åˆ†æ¯”å½¢å¼: "ç™¾åˆ†æ¯”*ç™¾åˆ†æ¯”" å¦‚ "50%*30%"
        ğŸ”¢ å•ç™¾åˆ†æ¯”: "ç™¾åˆ†æ¯”" å¦‚ "50%" (ç›¸å½“äº"50%*50%")
        ğŸ”‘ å…³é”®è¯å½¢å¼: 
            "é»˜è®¤"â†’å±…ä¸­ | "å·¦ä¸Š" | "å³ä¸Š" | "å·¦ä¸‹" | "å³ä¸‹" 
            "å±…ä¸­" | "ä¸Šä¸­" | "ä¸‹ä¸­" | "å·¦ä¸­" | "å³ä¸­"
            "åå·¦ä¸Š" | "åå³ä¸Š" | "åå·¦ä¸‹" | "åå³ä¸‹"
            "éšæœº"â†’éšæœºä½ç½®
        âš ï¸ æ³¨æ„: 
        - æ•°å­—åæ ‡èŒƒå›´: 0 â‰¤ x â‰¤ å±å¹•å®½åº¦, 0 â‰¤ y â‰¤ å±å¹•é«˜åº¦
        - ç™¾åˆ†æ¯”èŒƒå›´: 1% ~ 100%
        
    chuangkou_daxiao: str/tuple
        ğŸ“ çª—å£å¤§å° - æ”¯æŒä»¥ä¸‹æ ¼å¼:
        ğŸ“ å°ºå¯¸å½¢å¼: "æ•°å­—*æ•°å­—" å¦‚ "800*600"
        ğŸ“ˆ ç™¾åˆ†æ¯”å½¢å¼: "ç™¾åˆ†æ¯”*ç™¾åˆ†æ¯”" å¦‚ "80%*60%"
        ğŸ”¢ å•ç™¾åˆ†æ¯”: "ç™¾åˆ†æ¯”" å¦‚ "70%" (ç›¸å½“äº"70%*70%")
        ğŸ”‘ å…³é”®è¯å½¢å¼:
            "é»˜è®¤"â†’å±…ä¸­åŠå± | "æœ€å¤§åŒ–"â†’å…¨å±
            "å·¦åŠå±" | "å³åŠå±" | "ä¸ŠåŠå±" | "ä¸‹åŠå±"
            "å±…ä¸­åŠå±"â†’å®½é«˜å„åŠå±
        âš ï¸ æ³¨æ„:
        - æœ€å°å°ºå¯¸é™åˆ¶: 100*100åƒç´ 
        - ç™¾åˆ†æ¯”èŒƒå›´: 10% ~ 100%
        
    chuangkou_zhiding: bool
        ğŸ“Œ çª—å£ç½®é¡¶ - æ˜¯å¦ä¿æŒåœ¨æœ€ä¸Šå±‚
        âœ… True: ç½®é¡¶ | âŒ False: ä¸ç½®é¡¶
        ğŸ”„ è¿è¡Œæ—¶å¯é€šè¿‡window.attributes('-topmost', True/False)åŠ¨æ€ä¿®æ”¹
        
    chuangkou_lashen: str
        ğŸ‹ï¸ çª—å£æ‹‰ä¼¸æ–¹å¼:
        "ä¸æ‹‰ä¼¸"â†’å›ºå®šå¤§å° | "ä»»æ„æ‹‰ä¼¸"â†’è‡ªç”±è°ƒæ•´
        "æŒ‰æ¯”ä¾‹æ‹‰ä¼¸"â†’ä¿æŒå®½é«˜æ¯”è°ƒæ•´
        âš ï¸ æ³¨æ„: 
        - é€‰æ‹©"æŒ‰æ¯”ä¾‹æ‹‰ä¼¸"æ—¶ï¼Œçª—å£åˆå§‹å¤§å°å†³å®šå®½é«˜æ¯”
        - "æœ€å¤§åŒ–"çª—å£æ—¶å»ºè®®é€‰æ‹©"ä¸æ‹‰ä¼¸"
        
    ğŸ è¿”å›å€¼: tk.Tk çª—å£å¯¹è±¡
    """
    
    # è·å–å±å¹•å°ºå¯¸ ğŸ–¥ï¸
    screen = screeninfo.get_monitors()[0]
    screen_width = screen.width
    screen_height = screen.height
    
    # åˆ›å»ºçª—å£ ğŸ—ï¸
    window = tk.Tk()
    window.title(f"{chuangkou_mingcheng}")
    
    # å¤„ç†çª—å£ä½ç½® ğŸ“
    def chuli_weizhi(weizhi):
        # å¤„ç†æ•°å­—*æ•°å­— æˆ– ç™¾åˆ†æ¯”*ç™¾åˆ†æ¯” æˆ– å•ç™¾åˆ†æ¯”
        if isinstance(weizhi, str):
            if '*' in weizhi:
                left, top = weizhi.split('*')
            else:
                left = top = weizhi
            
            if '%' in left:
                left = max(1, min(100, int(left[:-1]))) / 100 * screen_width
                top = max(1, min(100, int(top[:-1]))) / 100 * screen_height
            else:
                left = max(0, min(screen_width, int(left)))
                top = max(0, min(screen_height, int(top)))
            return f"+{int(left)}+{int(top)}"
        
        # å¤„ç†å…³é”®è¯ä½ç½®
        weizhi_dict = {
            "é»˜è®¤": (screen_width//2, screen_height//2),
            "å·¦ä¸Š": (0, 0),
            "å³ä¸Š": (screen_width, 0),
            "å·¦ä¸‹": (0, screen_height),
            "å³ä¸‹": (screen_width, screen_height),
            "å±…ä¸­": (screen_width//2, screen_height//2),
            "ä¸Šä¸­": (screen_width//2, 0),
            "ä¸‹ä¸­": (screen_width//2, screen_height),
            "å·¦ä¸­": (0, screen_height//2),
            "å³ä¸­": (screen_width, screen_height//2),
            "åå·¦ä¸Š": (screen_width//4, screen_height//4),
            "åå³ä¸Š": (screen_width*3//4, screen_height//4),
            "åå·¦ä¸‹": (screen_width//4, screen_height*3//4),
            "åå³ä¸‹": (screen_width*3//4, screen_height*3//4),
            "éšæœº": (random.randint(0, screen_width), random.randint(0, screen_height))
        }
        left, top = weizhi_dict.get(weizhi, weizhi_dict["é»˜è®¤"])
        return f"+{left}+{top}"
    
    # å¤„ç†çª—å£å¤§å° ğŸ“
    def chuli_daxiao(daxiao):
        # å¤„ç†æ•°å­—*æ•°å­— æˆ– ç™¾åˆ†æ¯”*ç™¾åˆ†æ¯” æˆ– å•ç™¾åˆ†æ¯”
        if isinstance(daxiao, str):
            if '*' in daxiao:
                width, height = daxiao.split('*')
            else:
                width = height = daxiao
            
            if '%' in width:
                width = max(10, min(100, int(width[:-1]))) / 100 * screen_width
                height = max(10, min(100, int(height[:-1]))) / 100 * screen_height
            else:
                width = max(100, min(screen_width, int(width)))
                height = max(100, min(screen_height, int(height)))
            return f"{int(width)}x{int(height)}"
        
        # å¤„ç†å…³é”®è¯å¤§å°
        daxiao_dict = {
            "é»˜è®¤": (screen_width//2, screen_height//2),
            "æœ€å¤§åŒ–": (screen_width, screen_height),
            "å·¦åŠå±": (screen_width//2, screen_height),
            "å³åŠå±": (screen_width//2, screen_height),
            "ä¸ŠåŠå±": (screen_width, screen_height//2),
            "ä¸‹åŠå±": (screen_width, screen_height//2),
            "å±…ä¸­åŠå±": (screen_width//2, screen_height//2)
        }
        width, height = daxiao_dict.get(daxiao, daxiao_dict["é»˜è®¤"])
        return f"{width}x{height}"
    
    # è®¾ç½®çª—å£å‡ ä½•å±æ€§ âœ¨
    window.geometry(f"{chuli_daxiao(chuangkou_daxiao)}{chuli_weizhi(chuangkou_weizhi)}")
    
    # è®¾ç½®çª—å£ç½®é¡¶ ğŸ“Œ
    if chuangkou_zhiding:
        window.attributes('-topmost', True)
    
    # è®¾ç½®çª—å£æ‹‰ä¼¸æ–¹å¼ ğŸ‹ï¸
    if chuangkou_lashen == "ä¸æ‹‰ä¼¸":
        window.resizable(False, False)
    elif chuangkou_lashen == "æŒ‰æ¯”ä¾‹æ‹‰ä¼¸":
        # ä¿æŒå®½é«˜æ¯” ğŸ”„
        width, height = map(int, window.geometry().split('+')[0].split('x'))
        aspect_ratio = width / height
        
        def enforce_aspect_ratio(event):
            new_width = event.width
            new_height = int(new_width / aspect_ratio)
            window.geometry(f"{new_width}x{new_height}")
        
        window.bind("<Configure>", enforce_aspect_ratio)
    
    return window




# åˆ›å»ºçª—å£ä½¿ç”¨æ¨¡æ¿
# å¯¼å…¥åˆ›å»ºçª—å£æ¨¡å— ğŸ§©
from chuangjian_chuangkou_module import chuangjian_chuangkou

# ğŸŒŸ å‚æ•°å®šä¹‰åŒº ğŸŒŸ
# ----------------------------
çª—å£åç§° = "ğŸŸ¥æ™ºèƒ½æ•°æ®åˆ†æçœ‹æ¿ ğŸ“ŠğŸ”²âœï¸"  
# ğŸ·ï¸ çª—å£åç§° (å¿…å¡«) - æ˜¾ç¤ºåœ¨çª—å£é¡¶éƒ¨çš„åç§°
# ğŸŒ èŒƒå›´: ä»»æ„å­—ç¬¦ä¸²ï¼Œå»ºè®®é•¿åº¦â‰¤50å­—ç¬¦
# ğŸ’¡ ç¤ºä¾‹: "æˆ‘çš„åº”ç”¨", "ç³»ç»Ÿç›‘æ§é¢æ¿"

çª—å£ä½ç½® = "ğŸŸ¥é»˜è®¤ğŸ”²âœï¸"  
# ğŸ“ çª—å£ä½ç½® (å¯é€‰ï¼Œé»˜è®¤"å±…ä¸­") - é¦–æ¬¡æ‰“å¼€çª—å£æ—¶çª—å£çš„ä½ç½®,æ”¯æŒä»¥ä¸‹æ ¼å¼:
# ğŸ¯ æ ¼å¼é€‰é¡¹:
# 1. "å·¦è¾¹è·*ä¸Šè¾¹è·" â†’ å¦‚ "300*200" (åŒæ—¶ä¹Ÿæ˜¯çª—å£å·¦ä¸Šè§’åæ ‡,å•ä½åƒç´ px)
# 2. "ç™¾åˆ†æ¯”*ç™¾åˆ†æ¯”" â†’ å¦‚ "50%*30%" (å·¦è¾¹è·ä¸ä¸Šè¾¹è·å å±å¹•ç™¾åˆ†æ¯”)
# 3. "å•ç™¾åˆ†æ¯”" â†’ å¦‚ "50%" (ç›¸å½“äº"50%*50%")
# 4. ä½ç½®å…³é”®è¯ â†’ "é»˜è®¤/å·¦ä¸Š/å³ä¸Š/å·¦ä¸‹/å³ä¸‹/å±…ä¸­/ä¸Šä¸­/ä¸‹ä¸­/å·¦ä¸­/å³ä¸­/åå·¦ä¸Š/åå³ä¸Š/åå·¦ä¸‹/åå³ä¸‹/éšæœº"
# âš ï¸ å‚æ•°èŒƒå›´:
# - å·¦è¾¹è·ä¸ä¸Šè¾¹è·: 0 â‰¤ x â‰¤ å±å¹•å®½åº¦, 0 â‰¤ y â‰¤ å±å¹•é«˜åº¦
# - ç™¾åˆ†æ¯”: 1% ~ 100%

çª—å£å¤§å° = "ğŸŸ¥é»˜è®¤ğŸ”²âœï¸"      
# ğŸ“ çª—å£å¤§å° (å¯é€‰ï¼Œé»˜è®¤"å±…ä¸­åŠå±")
# ğŸ“ æ ¼å¼é€‰é¡¹:
# 1. "å®½*é«˜" â†’ å¦‚ "800*600" (çª—å£å°ºå¯¸,å•ä½åƒç´ px)
# 2. "ç™¾åˆ†æ¯”*ç™¾åˆ†æ¯”" â†’ å¦‚ "80%*60%" (å®½å’Œé«˜å å±å¹•ç™¾åˆ†æ¯”)
# 3. "ç™¾åˆ†æ¯”" â†’ å¦‚ "70%" (ç›¸å½“äº"70%*70%")
# 4. å¤§å°å…³é”®è¯ â†’ "é»˜è®¤/æœ€å¤§åŒ–/å·¦åŠå±/å³åŠå±/ä¸ŠåŠå±/ä¸‹åŠå±/å±…ä¸­åŠå±"
# âš ï¸ é™åˆ¶:
# - æœ€å°å°ºå¯¸: 100*100åƒç´ 
# - ç™¾åˆ†æ¯”: 10% ~ 100%

çª—å£ç½®é¡¶ = ğŸŸ¥TrueğŸ”²âœï¸             
# ğŸ“Œ çª—å£ç½®é¡¶ (å¯é€‰å‚æ•°ï¼Œé»˜è®¤False) - æ˜¯å¦ä¿æŒåœ¨æœ€ä¸Šå±‚
# âœ… True: çª—å£ä¿æŒåœ¨æœ€ä¸Šå±‚
# âŒ False: æ­£å¸¸çª—å£å±‚çº§
# ğŸ’¡ å¯é€šè¿‡window.attributes('-topmost', True/False)åŠ¨æ€ä¿®æ”¹

çª—å£æ‹‰ä¼¸ = "ğŸŸ¥æŒ‰æ¯”ä¾‹æ‹‰ä¼¸ğŸ”²âœï¸"        
# ğŸ‹ï¸ çª—å£æ‹‰ä¼¸æ–¹å¼ (å¯é€‰å‚æ•°ï¼Œé»˜è®¤"ä¸æ‹‰ä¼¸")
# å¯é€‰å€¼:
# "ä¸æ‹‰ä¼¸" â†’ å›ºå®šçª—å£å¤§å°
# "ä»»æ„æ‹‰ä¼¸" â†’ è‡ªç”±è°ƒæ•´çª—å£å°ºå¯¸
# "æŒ‰æ¯”ä¾‹æ‹‰ä¼¸" â†’ ä¿æŒåˆå§‹å®½é«˜æ¯”è°ƒæ•´
# âš ï¸ æ³¨æ„:
# - "æœ€å¤§åŒ–"çª—å£æ—¶å»ºè®®ä¸é€‰æ‹©"ä»»æ„æ‹‰ä¼¸"
# - "æŒ‰æ¯”ä¾‹æ‹‰ä¼¸"æ—¶åˆå§‹å¤§å°å†³å®šå®½é«˜æ¯”

# ğŸš€ åˆ›å»ºçª—å£ - å‰é¢å˜é‡appä¸ºè‡ªå®šä¹‰çª—å£å,ç”¨äºæŒ‡ä»£çª—å£å¯¹è±¡,å¯ä¿®æ”¹
ğŸŸ¥appğŸ”²âœï¸ = chuangjian_chuangkou(
    chuangkou_mingcheng=çª—å£åç§°,
    chuangkou_weizhi=çª—å£ä½ç½®,
    chuangkou_daxiao=çª—å£å¤§å°,
    chuangkou_zhiding=çª—å£ç½®é¡¶,
    chuangkou_lashen=çª—å£æ‹‰ä¼¸
)

# ğŸƒâ€â™‚ï¸ å¯åŠ¨çª—å£ï¼Œï¼ˆä¹Ÿå«ä¸»äº‹ä»¶å¾ªç¯ï¼Œçª—å£ä¸€ç›´ç­‰å¾…ç”¨æˆ·è¾“å…¥æˆ–ç‚¹å‡»ç­‰åŠ¨ä½œ/äº‹ä»¶ï¼‰
# âš ï¸ æ³¨æ„: å¯åŠ¨çª—å£è¿™ä¸ªè¯­å¥è¦å†™åœ¨æœ€ä¸‹é¢ï¼Œä¸ç„¶å…¶ä»–è¯­å¥ä¼šè¢«å¿½ç•¥è€Œæ— æ³•æ‰§è¡Œ
ğŸŸ¥appğŸ”²âœï¸.mainloop()  # å˜é‡appè¦ä¸åˆ›å»ºçª—å£æ—¶ä½¿ç”¨çš„å˜é‡åä¿æŒä¸€è‡´,æ­¤å˜é‡åç”¨äºæŒ‡ä»£çª—å£å¯¹è±¡
